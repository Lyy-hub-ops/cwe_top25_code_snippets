static int
cdp_guess(char *pos, int length, int version)
{
	const u_int8_t mcastaddr[] = CDP_MULTICAST_ADDR;
	if (length < 2 * ETHER_ADDR_LEN + sizeof(u_int16_t) /* Ethernet */ +
		8 /* LLC */ + 4 /* CDP header */)
		return 0;
	if (PEEK_CMP(mcastaddr, ETHER_ADDR_LEN) != 0) return 0;
	PEEK_DISCARD(ETHER_ADDR_LEN);
	PEEK_DISCARD_UINT16; /* Ethernet */
	PEEK_DISCARD(8);     /* LLC */
	return (PEEK_UINT8 == version);
}