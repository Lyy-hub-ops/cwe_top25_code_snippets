bool HasFourByteBannedCharAtIndex(const STR& escaped_text,
                                  unsigned char first_byte,
                                  size_t index) {
  // The following characters are blacklisted for spoofability concerns.
  // U+1F50F LOCK WITH INK PEN         (%F0%9F%94%8F)
  // U+1F510 CLOSED LOCK WITH KEY      (%F0%9F%94%90)
  // U+1F512 LOCK                      (%F0%9F%94%92)
  // U+1F513 OPEN LOCK                 (%F0%9F%94%93)
  if (first_byte != 0xF0)
    return false;

  unsigned char second_byte;
  if (!UnescapeUnsignedCharAtIndex(escaped_text, index + 3, &second_byte) ||
      second_byte != 0x9F) {
    return false;
  }

  unsigned char third_byte;
  if (!UnescapeUnsignedCharAtIndex(escaped_text, index + 6, &third_byte) ||
      third_byte != 0x94) {
    return false;
  }

  unsigned char fourth_byte;
  return UnescapeUnsignedCharAtIndex(escaped_text, index + 9, &fourth_byte) &&
         (fourth_byte == 0x8F || fourth_byte == 0x90 || fourth_byte == 0x92 ||
          fourth_byte == 0x93);
}