inline FIO_FUNC ssize_t fio_str_send_free2(const intptr_t uuid,
                                           const fio_str_s *str) {
  if (!str)
    return 0;
  fio_str_info_s state = fio_str_info(str);
  return fio_write2(uuid, .data.buffer = str, .length = state.len,
                    .offset = ((uintptr_t)state.data - (uintptr_t)str),
                    .after.dealloc = (void (*)(void *))fio_str_free2);
}