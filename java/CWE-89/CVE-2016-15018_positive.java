@Transactional
    @Override
    public <E extends KrailEntity<ID, VER>> Optional<E> delete(@Nonnull E entity) {
        checkNotNull(entity);
        E mergedEntity = merge(entity);
        if (mergedEntity.getId() != null) {
            //noinspection unchecked
            return deleteById((Class<E>) entity.getClass(), mergedEntity.getId());
        }
        return Optional.empty();
    }